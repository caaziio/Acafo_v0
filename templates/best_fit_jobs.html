{% extends "layout.html" %}
{% block title %}Best Fit Jobs{% endblock %}
{% block page_title %}Best Fit Jobs in Korea{% endblock %}
{% block content %}
<style>
  .requirements-flex {
    display: flex;
    gap: 20px;
    justify-content: center;
    margin-bottom: 2rem;
    flex-wrap: wrap;
    width: 100%;
  }
  .requirement-card {
    flex: 1 1 200px;
    min-width: 200px;
    max-width: 340px;
    background: #f3f4f6; /* grey for incomplete */
    border: 1px solid #d1d5db;
    border-radius: 18px;
    padding: 28px 18px 20px 18px;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    transition: background 0.2s, border 0.2s;
    position: relative;
    text-align: center;
  }
  .requirement-card.complete {
    background: #f0fdf4; /* very light green for completed cards */
    border: 1px solid #4ade80;
    box-shadow: 0 2px 12px rgba(16,185,129,0.10);
  }
  .requirement-icon {
    font-size: 2.2rem;
    margin-bottom: 10px;
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 2.2rem;
  }
  .requirement-card.complete .requirement-icon {
    color: #22c55e;
  }
  .requirement-card.incomplete .requirement-icon {
    color: #d1d5db;
  }
  .requirement-title {
    font-weight: 700;
    font-size: 1.08rem;
    margin-bottom: 6px;
    color: #059669;
  }
  .requirement-card.incomplete .requirement-title {
    color: #64748b;
  }
  .requirement-desc {
    color: #64748b;
    font-size: 0.97rem;
    margin-bottom: 12px;
  }
  .requirement-action {
    margin-top: 8px;
    width: 100%;
  }
  @media (max-width: 900px) {
    .requirements-flex { flex-wrap: wrap; gap: 16px; }
    .requirement-card { min-width: 160px; max-width: 100%; }
  }
  @media (max-width: 600px) {
    .requirements-flex { flex-direction: column; gap: 14px; }
    .requirement-card { min-width: 0; width: 100%; }
  }
  .analyse-btn-centered {
    display: block;
    margin: 2rem auto 0 auto;
    width: 220px;
    max-width: 90vw;
  }
  .circle-check {
    width: 2.2rem;
    height: 2.2rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: #bbf7d0;
    border: 1.5px solid #4ade80;
  }
  .circle-check svg {
    width: 1.3rem;
    height: 1.3rem;
    color: #22c55e;
    display: block;
  }
  .bestfit-layout-card {
    width: 100%;
    max-width: 100%;
    margin: 0 auto;
    border-radius: 16px;
    padding-left: 40px;
    padding-right: 40px;
    box-sizing: border-box;
  }
</style>
<div class="card bestfit-layout-card">
  <h2 style="font-size:1.5rem;font-weight:700;margin-bottom:1.5rem;text-align:center;">Find Your Best Fit Jobs in Korea</h2>
  <div id="progressBar" style="margin-bottom:2rem;">
    <div style="display:flex;align-items:center;gap:12px;">
      <div style="flex:1;height:12px;background:#e5e7eb;border-radius:8px;overflow:hidden;">
        <div id="progressFill" style="height:100%;width:{{ (requirements|selectattr('complete')|list|length / requirements|length * 100)|round(0) }}%;background:linear-gradient(90deg,#2563eb,#60a5fa);transition:width 0.4s;"></div>
      </div>
      <span id="progressText" style="font-size:1rem;font-weight:600;color:#2563eb;min-width:90px;text-align:right;">{{ requirements|selectattr('complete')|list|length }} of {{ requirements|length }}</span>
    </div>
  </div>
  <div class="requirements-flex">
    {% for req in requirements %}
      <div class="requirement-card {{ 'complete' if req.complete else 'incomplete' }}">
        <div class="requirement-icon">
          {% if req.complete %}
            <span class="circle-check">
              <svg viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="9" stroke="#4ade80" stroke-width="2" fill="#bbf7d0"/><path d="M6 10.5l3 3 5-5" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </span>
          {% else %}
            <span style="font-size:2rem;">â¬œ</span>
          {% endif %}
        </div>
        <div class="requirement-title">{{ req.label }}</div>
        <div class="requirement-desc">{{ req.desc }}</div>
        <a href="{{ req.action.href }}" class="btn btn-secondary requirement-action">Edit</a>
      </div>
    {% endfor %}
  </div>
  <div style="margin: 18px auto 0 auto; max-width: 600px; background: #f0f9ff; border: 1px solid #bfdbfe; color: #2563eb; border-radius: 10px; padding: 14px 18px; text-align: center; font-size: 1rem;">
    <span style="font-size:1.2em;vertical-align:middle;">ðŸ’¡</span> Complete all requirements above to start the analysis.
  </div>
  {% set completed = requirements|selectattr('complete')|list|length %}
  <button id="analyseBtn" class="btn btn-primary analyse-btn-centered" style="opacity:{{ 1 if completed == requirements|length else 0.6 }};pointer-events:{{ 'auto' if completed == requirements|length else 'none' }};">Analyse</button>
</div>
{% endblock %}
